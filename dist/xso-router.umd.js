(function(a,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(a=typeof globalThis<"u"?globalThis:a||self,r(a.router={}))})(this,function(a){var it,I,F,D,J,q,S,H,X,x,z,w,B,U,pt,G,k,M,m,j,b,O,Q,N,W,Y,p,R,A,st,Nt,rt,Tt,ot,$t,Z,dt;"use strict";var It=Object.defineProperty;var Ft=(a,r,f)=>r in a?It(a,r,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[r]=f;var jt=(a,r,f)=>(Ft(a,typeof r!="symbol"?r+"":r,f),f),ft=(a,r,f)=>{if(!r.has(a))throw TypeError("Cannot "+f)};var n=(a,r,f)=>(ft(a,r,"read from private field"),f?f.call(a):r.get(a)),u=(a,r,f)=>{if(r.has(a))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(a):r.set(a,f)},h=(a,r,f,K)=>(ft(a,r,"write to private field"),K?K.call(a,f):r.set(a,f),f);var E=(a,r,f)=>(ft(a,r,"access private method"),f);function r(e,t,s,o){if(r.null==t)throw new Error(`${s} is null and not a valid ${e}.`);if(r.invalid==t)throw new Error(`${s} is ${typeof o} and not a valid ${e}.`)}r.array="array",r.function="function",r.object="object",r.string="string",r.null=0,r.invalid=1;function f(e,t){t==null&&r(r.array,r.null,e,t),(typeof t!="object"||!Array.isArray(t))&&r(r.array,r.invalid,e,t)}function K(e,t){t==null&&r(r.function,r.null,e,t),typeof t!="function"&&r(r.function,r.invalid,e,t)}function T(e,t){t==null&&r(r.object,r.null,e,t),(typeof t!="object"||Array.isArray(t))&&r(r.object,r.invalid,e,t)}function tt(e,t){t==null&&r(r.string,r.null,e,t),typeof t!="string"&&!(t instanceof String)&&r(r.string,r.invalid,e,t)}function L(e){return typeof e=="object"&&e!=null&&Array.isArray(e)}function xt(e){return typeof e=="function"&&e!=null}function et(e){return typeof e=="object"&&e!=null&&!Array.isArray(e)}function nt(e){return(typeof e=="string"||e instanceof String)&&e!=null}const mt=[],yt="_xso_com_",v={COMPONENTS:mt,COMPONENTS_PREFIX:yt,getComponent:e=>mt.find(t=>t.key==e).instance,isKey:e=>e.indexOf(yt)==0};class lt{constructor(t,s){u(this,it,null);u(this,I,null);u(this,F,null);u(this,D,null);h(this,it,t),h(this,I,s)}get current(){return n(this,D)}set current(t){h(this,D,t),n(this,I).fire(this)}set(t){return h(this,F,t),this}get(){return n(this,F)}}it=new WeakMap,I=new WeakMap,F=new WeakMap,D=new WeakMap,lt.prototype.toString=function(){return this.current};function Mt(e,t,s){T("Properties",t);const o=l=>new Error(`Content of type ${typeof l} is not valid, only string, object, or array with objects.`);for(const l of Object.keys(t)){const i=t[l];if(l=="_"&&i)if(nt(i))e.textContent=i;else if(L(i))P(e,i,s);else if(et(i))P(e,[i],s);else throw o(i);else if(l=="$"&&i)if(nt(i))e.innerHTML=i;else if(L(i))P(e,i,s,!0);else if(et(i))P(e,[i],s,!0);else throw o(i);else if(l=="text"&&i)tt(l,i),e.innerText=i;else if(l=="html"&&i)tt(l,i),e.innerHTML=i;else if(l=="style"&&i){T(l,i);for(const c of Object.keys(i))e.style[c]=i[c]}else if(l=="className"&&i)tt(l,i),e.className=i;else if(l=="classList"&&i)wt(e,i);else if(l=="class"&&i){if(nt(i))e.className=i;else if(L(i))wt(e,i);else if(i!=null&&i!=null)throw new Error(`CSS Class of type ${typeof i} is not valid, only string or array of strings is accepted.`)}else l.indexOf("on")==0?(K(l,i),e.addEventListener(l.substring(2).toLowerCase(),i)):e.setAttribute(l,i)}}function wt(e,t){f(key,t);for(const s of t)tt(s),e.classList.add(s)}function P(e,t,s,o){const l=[];if(et(t))if(t instanceof lt){const i=P(e,t.get(),s);if(i.length==0)throw new Error("Reference is empty with no valid elements.");if(i.length>1)throw new Error("Reference with more than 1 element.");t.current=i[0]}else{const i=Object.keys(t);if(i.length>1)throw new Error(`Object with more than 1 keys: ${i.join(", ")}`);if(i.length==0)throw new Error("Object with no key, but one is required.");for(const c of i){const d=t[c];if(v.isKey(c)){const g=v.getComponent(c).clone();g.parent=e,g.render(d),s&&s.appendChildComponent(g),l.push(g)}else{const g=document.createElement(c);Mt(g,d,s),l.push(g),e.appendChild(g)}}}else if(L(t))for(const i of t)if(nt(i))if(o){const c=document.createElement("span");c.innerHTML=i,e.appendChild(c),l.push(i)}else{const c=document.createTextNode(i);e.appendChild(c),l.push(i)}else P(e,i,s);else throw new Error(`View of type ${typeof t} is invalid, only object or array of objects.`);return l}class gt{constructor(t,s){u(this,J,null);u(this,q,null);u(this,S,null);u(this,H,null);h(this,J,t),h(this,S,s)}set val(t){JSON.stringify(n(this,H))!=JSON.stringify(t)&&(h(this,q,n(this,S)),h(this,S,t),h(this,H,JSON.stringify(t)),console.log("Props >> "+n(this,J).key(),t))}get val(){return n(this,S)}get previous(){return n(this,q)}}J=new WeakMap,q=new WeakMap,S=new WeakMap,H=new WeakMap,gt.prototype.toString=function(){return this.val};class vt{constructor(t,s,o){u(this,U);u(this,X,null);u(this,x,null);u(this,z,null);u(this,w,null);u(this,B,0);h(this,X,t),h(this,x,s),h(this,w,o)}set $val(t){n(this,w)!==t&&(E(this,U,pt).call(this,t),n(this,X).render(),n(this,x).fire(this))}get $val(){return n(this,w)}set val(t){n(this,w)!==t&&(E(this,U,pt).call(this,t),n(this,x).fire(this))}get val(){return n(this,w)}get previous(){return n(this,z)}get lastChanged(){return n(this,B)}}X=new WeakMap,x=new WeakMap,z=new WeakMap,w=new WeakMap,B=new WeakMap,U=new WeakSet,pt=function(t){h(this,z,n(this,w)),h(this,w,t),h(this,B,Date.now())},vt.prototype.toString=function(){return this.val};class Rt{constructor(){u(this,G,[]);u(this,k,[])}add(t,s){n(this,G).push({items:t,func:s})}fire(t){const s=n(this,G).filter(o=>o.items.includes(t));for(const o of s)o&&!n(this,k).includes(o.func)&&(n(this,k).push(o.func),setTimeout(()=>{n(this,k).splice(n(this,k).indexOf(o.func),1),o.func()},0))}}G=new WeakMap,k=new WeakMap;function Ct(e){return e instanceof C}function ut(e){if(!Ct(e))throw new Error("Invalid component, because not implement the component class.")}const at=class{constructor(t){u(this,st);u(this,rt);u(this,ot);u(this,Z);u(this,M,!1);u(this,m,null);u(this,j,null);u(this,b,null);u(this,O,null);u(this,Q,[]);u(this,N,()=>{});u(this,W,()=>{});u(this,Y,()=>{});u(this,p,{elements:[],components:[]});u(this,R,new Rt);jt(this,"parent",null);u(this,A,null);if(!xt(t)||t.toString().indexOf("function")!=0)throw new Error("Only classic functions are used for components and arrow function is not supported.");h(this,m,t),E(this,st,Nt).call(this)}name(){return n(this,m).name}clone(){return new at(n(this,m))}childrenElements(){return[...n(this,p).elements]}childrenComponents(){return[...n(this,p).components]}appendChildComponent(t){ut(t),n(this,p).components.push(t)}mount(t){t?h(this,N,t):n(this,N).call(this)}unmount(t){t?h(this,W,t):(E(this,ot,$t).call(this),E(this,rt,Tt).call(this),n(this,W).call(this))}view(t){h(this,Y,t)}ref(){return new lt(this,n(this,R))}changes(t,s){n(this,R).add(t,s)}render(t){var o;const s=this;n(this,b)?(n(this,A)&&clearTimeout(n(this,A)),h(this,A,setTimeout(()=>{var l;E(l=s,Z,dt).call(l,t)},0))):E(o=s,Z,dt).call(o,t)}static isSameKind(t,s){let o=null;for(const i of Object.keys(t))o=i;const l=v.getComponent(o);return n(l,m)===n(s,m)}function(){return n(this,m)}key(){return n(this,j)}destroy(){const t=v.COMPONENTS.findIndex(s=>s.key==n(this,j));v.COMPONENTS.splice(t,1)}state(t){if(n(this,O))return n(this,Q)[n(this,O).state++];const s=new vt(this,n(this,R),t);return n(this,Q).push(s),s}};let C=at;M=new WeakMap,m=new WeakMap,j=new WeakMap,b=new WeakMap,O=new WeakMap,Q=new WeakMap,N=new WeakMap,W=new WeakMap,Y=new WeakMap,p=new WeakMap,R=new WeakMap,A=new WeakMap,st=new WeakSet,Nt=function(){for(;;){const t=v.COMPONENTS_PREFIX+"["+n(this,m).name+"]_"+(Math.random()+1).toString(36).substring(2);if(!v.COMPONENTS.find(s=>s.key==t)){h(this,j,t);break}}v.COMPONENTS.push({key:n(this,j),instance:this})},rt=new WeakSet,Tt=function(){if(n(this,p).elements.length>0){if(parent=n(this,p).elements[0].parentNode,parent==null)return;for(const t of n(this,p).elements)parent.contains(t)&&parent.removeChild(t)}},ot=new WeakSet,$t=function(){for(const t of n(this,p).components)t.unmount();n(this,p).components=[]},Z=new WeakSet,dt=function(t){n(this,b)?t?n(this,b).val=t:h(this,O,{state:0}):h(this,b,new gt(this,t)),n(this,M)==!1&&n(this,m).bind(this)(n(this,b).val);let s=n(this,Y).bind(this)();(!s||s.length==0)&&(s=[{span:{style:{display:"none"}}}]);let o=null;n(this,O)&&(o=n(this,p).elements[0].parentNode);const l=document.createDocumentFragment(),i=n(this,p).components;if(n(this,p).components=[],P(l,s,this),n(this,O)){const c=[];for(const d of l.children)c.push(d);if(n(this,p).elements.length==0)this.parent.appendChild(l);else{o.insertBefore(l,n(this,p).elements[0]);for(const d of i)d.unmount();for(const d of n(this,p).elements)o.contains(d)&&o.removeChild(d)}n(this,p).elements=c}else{for(const c of l.children)n(this,p).elements.push(c);this.parent.appendChild(l)}h(this,O,null),n(this,M)==!1&&(h(this,M,!0),n(this,N)&&window.setTimeout(n(this,N),0))},C.prototype.toString=function(){return this.key()},C.prototype.isSameKind=function(e,t){return C.isSameKind(e,t)};function At(e){T("Component Props",e);let t=null;for(const s of Object.keys(e)){if(t!=null)throw new Error(`More than 1 component in the same object: ${e}`);t=e[s],T("Component Props Loaded",t)}return t}function Ot(e){T("jsonDefinition of an invalid object.",e);let t=null;for(const o of Object.keys(e))t=o;let s=t;return t.indexOf(v.COMPONENTS_PREFIX)==0&&(s=t.substring(t.indexOf("[")+1,t.lastIndexOf("]"))),JSON.stringify({[s]:e[t]})}function _(e,t){const s=o=>new Error(`Only ${t.function().name} type is accepted! This component is invalid: ${Ot(o)}`);if(L(e)){for(const o of e)if(T("ensureSameKind of an invalid object.",o),!C.isSameKind(o,t))throw s(o)}else if(et(e)){if(!C.isSameKind(e,t))throw s(e)}else throw new Error("Invalid kind.")}_.required=(e,t)=>{if(e)return _(e,t);throw new Error(`${t.name()} is required.`)},_.optional=(e,t)=>{e&&_(e,t)};function y(e){return K("Component",e),new C(e)}y.create=(e,t,s)=>{ut(t),t.parent=e,t.render(s)},y.ensure=ut,y.is=Ct,y.ensureType=_,y.props=At,y.json=Ot;function Kt({path:e,component:t}){const s=this.state(!1),o=this.state(null);this.updatePath=l=>{const i=l.split("/"),c=e.split("/");let d=i.length==c.length;if(d){o.val={};for(const[g,V]of c.entries()){const kt=i[g];let ht=V.indexOf("{"),ct=V.indexOf("}");if(ht==0&&ht+1<ct&&ct==V.length-1)o.val[V.substring(ht+1,ct)]=kt;else if(V!=kt){d=!1;break}}if(d){s.$val=!0;return}}o.val={},s.$val=!1},this.view(()=>s.val?[{[t]:{route:{params:o.val}}}]:[])}const bt=y(Kt);let Et=null,Pt="/";const $=y(function({routes:e}){y.ensureType(e,bt),Et=this;const t=e.map(()=>this.ref());this.updatePath=s=>{for(const o of t)o.current.updatePath(s)},this.view(()=>{const s=[];for(const[o,l]of e.entries())s.push(t[o].set(l));return s})});$.updatePath=e=>{Pt=e,Et.updatePath(e)},$.currentPath=()=>Pt,window.addEventListener("load",function(e){const t=window.location.pathname;$.updatePath(t)}),window.addEventListener("popstate",function(e){const t=window.location.pathname;$.updatePath(t)});function Lt(e){const{to:t,top:s,onClick:o}=e,l={...e};delete l.to,delete l.top,delete l.onClick,this.view(()=>[{a:{onClick:()=>{let i=t,c=null;t.indexOf("#")>=0&&(i=t.substring(0,t.indexOf("#")),c=t.substring(t.indexOf("#")+1)),St(i),c&&window.setTimeout(()=>location.hash="#"+c,0),s!==!1&&window.scrollTo(0,0),o&&o()},...l}}])}const _t=y(Lt);function St(e){history.pushState(null,null,e),$.updatePath(e)}a.Navigate=_t,a.Route=bt,a.Router=$,a.navigateTo=St,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
